<section id="page-qtd-stack">
    <img src="images/back.svg" id="back-button" onclick="window.history.back()" class="clickable back-button"/>
    <article class="left center-text" style="width: 10vw;">  
        <h5>Height from bottom</h5>
        <h4><span id="vertical-value"></span>%</h4>
        <input id="vertical-slider" class="clickable vertical-slider" type="range" orient="vertical" min="20" max="80" value="50" />
        <div id="select" class="clickable" style="font-family:sans-serif">
            <p>Select a file: <input type="file" id="file" name="files" /></p>
            <p>Select a mask: <input type="file" id="mask" name="files" /></p>
            <hr />
            <button id="applymask">apply mask</button>
        </div>
    </article>
	<article class="center-stack center-text">

        <p class="center-text">
            QtD = <span id="qtd-value"></span>
        </p>

        <div id="graph" class="sliding-graph">
            <div id="graph-slider" class="line"></div>
            <canvas id="stack-chart" aria-label="QtD Graph" role="img"></canvas>
            
        </div>
        

	</article>
	<article class="right middle" style="width: 40vw;">

        <label for="range-slider" class="slider-description">
            Selection range
        </label>

        <img id="stack-image" class="side-pic" src="images/stack/image300.jpg">
        <img id="stack-block" class="side-pic" src="images/stack/block300.jpg">
        <div class="center-text">
            <img id="lung-pic" src="images/base-lung.png" class="lung-pic">
            <div id="h-line" class="horizontal-line"></div>
        </div>
        
        <input id="range-slider" class="clickable range-slider" type="range" orient="vertical" min="0" max="60" value="0" />
        
        
    </article>
    <img src="images/abi-hc-rgb-new.png" class="overlay">
    <img src="images/MedTech CoRE Logo.png" class="medtechlogo">
</section>

<script>
initStack();
document.getElementById('file').addEventListener('change', (e) => handleFileSelect(e, 'main'), false);
    document.getElementById('mask').addEventListener('change', (e) => handleFileSelect(e, 'mask'), false);
    //let showarray = document.getElementById('showarray');
    document.getElementById('applymask').addEventListener('click', () => {
        let mainArray = saveNifti.main.qtd
        let maskArray = saveNifti.mask.qtd
        let result = mask3d(mainArray, maskArray);
        result = computeQtD(result)
        result = processNifti(result);
        console.log(result);
        let arr = [];
        for(const x in result){
            arr.push(result[x]);
        }
        stackChart.data.datasets[0].data = arr;
        return result;
    });
</script>
